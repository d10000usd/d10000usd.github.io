/* empty css                                                                                 */import{_ as C,r as c,e as F,l as S,o as u,c as P,h as A,i as k}from"./index-ee0a90d6.js";const b=1,D={__name:"PluginWebsocket_tabChart",props:{message:Object},setup(_){const n=_,i=c({types:n.message.types,ticker:n.message.ticker,candlecnt:n.message.candlecnt,timeInterval:n.message.timeInterval}),r=c([{data:[]}]),d=c({chart:{type:"candlestick",height:350,animations:{enabled:!1}},xaxis:{type:"datetime"},legend:{show:!0,position:"left"},annotations:{yaxis:Array.from({length:6},()=>({y:0,type:"numeric",borderColor:"#FF4560",label:{borderColor:"#FF4560",style:{show:!0,color:"#999",offsetX:0,offsetY:0,lineWidth:2},text:""}}))},plotOptions:{candlestick:{colors:{upward:"#FF4560",downward:"#0070FF"}}}}),o=c({candle_date_time_kst:0,opening_price:0,high_price:0,low_price:0,trade_price:0}),h=c([]),v=c([]),y=async e=>{const t=await new Response(e.data).json(),s=Math.floor(t.timestamp/(24*60*60*1e3))*(24*60*60*1e3)+9*60*60*1e3;t.code==i.value.ticker&&(f(t,s),w(),console.log("WebSocket data received:",o.value))},f=(e,t)=>{o.value={candle_date_time_kst:t,opening_price:e.opening_price,high_price:e.high_price,low_price:e.low_price,trade_price:e.trade_price},m(o.value.high_price,h),m(o.value.low_price,v),x(o.value.candle_date_time_kst,[o.value.opening_price,o.value.high_price,o.value.low_price,o.value.trade_price])},w=()=>{const e=d.value.annotations.yaxis,t=o.value;let s=1.012,p=1.01;t.low_price*.01;const l=[{label:"[trate] ",y:t.trade_price*s,color:"#FFA500"},{label:"[tolerrance] ",y:t.low_price,color:"#008080"},{label:"[brate] ",y:t.trade_price*p,color:"#800080"}];e[0].lineWidth=12,e[1].lineWidth=23,e[2].lineWidth=34,e[3].lineWidth=21,e[4].lineWidth=12,e[5].lineWidth=23;for(let a=0;a<l.length;a++)e[a].y=l[a].y,e[a].label.text=l[a].label+l[a].y,e[a].borderColor=l[a].color,e[a].label.style.background=l[a].color;g(4,v),g(5,h)},W=()=>{try{const e=new WebSocket("wss://api.upbit.com/websocket/v1");e.onopen=t=>{e.send(JSON.stringify([{ticket:"test"},{type:"ticker",codes:[i.value.ticker]}]))},e.onclose=t=>{console.error("WebSocket closed:",t)},e.onmessage=y}catch(e){console.error("Error fetching candle data:",e)}};F(()=>{W()});const m=(e,t)=>{e!==t.value[t.value.length-1]&&t.value.push(e),t.value.length>b&&t.value.shift()},x=(e,t)=>{r.value[0].data.length>=b&&r.value[0].data.shift(),r.value[0].data.push({x:e,y:t})},g=(e,t)=>{const s=d.value.annotations.yaxis,p=t.value[t.value.length-2];s[e].y=p,s[e].label.text=`[${e===4?"pl":"ph"}] ${p}`};return(e,t)=>{const s=S("apexchart");return u(),P("div",null,[A(s,{type:"candlestick",options:d.value,series:r.value},null,8,["options","series"])])}}},I=C(D,[["__scopeId","data-v-6adbe180"]]),O={__name:"TsWebsocket",setup(_){const n=c({types:"candle",ticker:"KRW-BTC",candlecnt:123,timeInterval:"days"});return n.value.ticker,(i,r)=>(u(),k(I,{message:n.value,key:n.value},null,8,["message"]))}},z={__name:"PluginWebsocket_tabChartView",setup(_){return(n,i)=>(u(),k(O))}};export{z as default};
