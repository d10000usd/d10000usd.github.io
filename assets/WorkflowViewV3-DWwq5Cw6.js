import{h as De,g as j,c as M,a,o as l,b as e,C as se,t as k,n as E,z as J,j as P,F as z,d as I,l as de,r as Ne,x as X,K as te,e as V,v as $,P as Pe,A as Ue,U as Ve,f as be}from"./vendor-CPGvGDBM.js";import{ea as ze}from"./index-Q-2DXrkv.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Se={commonpath:{common:"generate.md",fileSystem:"/workspace",aiSystem:"/ai/models",newsSystem:"/news/data",messaging:"/messaging/data",stockSystem:"/stock/data",redisSystem:"/redis/cache",telegramSystem:"/telegram/data",kakaoSystem:"/kakao/data"},savepath:{userProfile:"pintload/report.md",fileCache:"xcload/files.dat",modelWeights:"load4/weights.model",newsFeed:"load1/newsfeed.xml",messages:"load2/messages.msg",stockData:"load3/stock_data.csv",workflowTemplates:"load5/workflow_templates.json",chartSettings:"load6/chart_settings.json"},aiConfig:{gpt4Model:"gpt-4",gpt35Model:"gpt-3.5-turbo",claudeModel:"claude-3-sonnet-20240229",temperature:.7,maxTokens:2e3,topP:.9,frequencyPenalty:0,presencePenalty:0},fileExtensions:{json:".json",txt:".txt",csv:".csv",md:".md",xml:".xml",dat:".dat",log:".log",yaml:".yaml"},prompt:{programmer:{commonpath:"프로그래머용 안내: commonpath는 공통 및 각 시스템의 파일 저장 베이스 경로입니다. 코드 내 경로 처리, 파일 입출력 시 참조하세요.",extension:"프로그래머용 안내: extension은 각 파일 타입에 따른 확장자입니다. 파일 생성/읽기 모듈에서 확장자 체크용으로 활용하세요.",filename:"프로그래머용 안내: filename은 각 시스템별 주요 파일명입니다. 디버깅, 테스트 파일명 기본값으로 사용하세요."},systemPrompts:{codeReview:"코드 리뷰를 수행하고 개선점을 제안하세요.",summarize:"다음 내용을 요약하세요.",translate:"다음 텍스트를 한국어로 번역하세요.",analyze:"다음 데이터를 분석하고 인사이트를 제공하세요."},templates:{greeting:"안녕하세요! 무엇을 도와드릴까요?",error:"오류가 발생했습니다: ",success:"작업이 성공적으로 완료되었습니다.",processing:"처리 중입니다..."}},urlTemplates:{newsApi:"https://api.news.com/v1/search?q={query}",stockApi:"https://api.stock.com/v1/quote/{symbol}",weatherApi:"https://api.weather.com/v1/current?city={city}",geocodeApi:"https://api.geocode.com/v1/address?q={address}"},timeFormats:{dateOnly:"YYYY-MM-DD",timeOnly:"HH:mm:ss",dateTime:"YYYY-MM-DD HH:mm:ss",iso8601:"YYYY-MM-DDTHH:mm:ss.SSSZ",timestamp:"X"},numberFormats:{currency:"#,##0.00",percent:"0.00%",decimal:"0.000",integer:"#,##0"}},G={MAPPING:"mapping",INPUT:"input",OUTPUT:"output",AUTO:"auto"},Ie={[G.MAPPING]:{position:"top",color:"#f59e0b",label:"MAP",allowInput:!0,allowOutput:!1,angle:270},[G.INPUT]:{position:"left",color:"#10b981",label:"IN",allowInput:!0,allowOutput:!1,angle:180},[G.OUTPUT]:{position:"right",color:"#3b82f6",label:"OUT",allowInput:!1,allowOutput:!0,angle:0},[G.AUTO]:{position:"bottom",color:"#8b5cf6",label:"AUTO",allowInput:!1,allowOutput:!0,angle:90}},Re={RADIUS:48},oe={NODE:"node",ACCUMULATED:"accumulated",CUSTOM:"custom"},Y={ARRAY:"array",NEWLINE:"newline",SPACE:"space",COMMA:"comma"},$e={[oe.NODE]:"노드 출력",[oe.ACCUMULATED]:"누적 데이터",[oe.CUSTOM]:"Custom Dataset"},Be={[Y.ARRAY]:"배열로 병합",[Y.NEWLINE]:"줄바꿈으로 병합",[Y.SPACE]:"공백으로 병합",[Y.COMMA]:"쉼표로 병합"},L={IDLE:"idle",EXECUTING:"executing",SUCCESS:"success",ERROR:"error"},ke={fileSystem:{icon:"📁",label:"FILE",color:"#3b82f6",bgGradient:"from-blue-500/20 to-blue-600/10"},newsSystem:{icon:"📰",label:"NEWS",color:"#10b981",bgGradient:"from-green-500/20 to-green-600/10"},kakaoSystem:{icon:"💬",label:"TALK",color:"#eab308",bgGradient:"from-yellow-500/20 to-yellow-600/10"},telegramSystem:{icon:"✈️",label:"TELE",color:"#a855f7",bgGradient:"from-purple-500/20 to-purple-600/10"},redisSystem:{icon:"💾",label:"DATA",color:"#ef4444",bgGradient:"from-red-500/20 to-red-600/10"},stockCandleSystem:{icon:"📈",label:"STOCK",color:"#f97316",bgGradient:"from-orange-500/20 to-orange-600/10"},timeSystem:{icon:"🕐",label:"TIME",color:"#6b7280",bgGradient:"from-gray-500/20 to-gray-600/10"},aiStreamSystem:{icon:"🤖",label:"AI",color:"#6366f1",bgGradient:"from-indigo-500/20 to-indigo-600/10"},system:{icon:"⚙️",label:"SYS",color:"#6b7280",bgGradient:"from-gray-500/20 to-gray-600/10"}},Me=(o,t)=>{let n=o;for(const c of t){if(n==null)return;n=n[c]}return n},Te=o=>!o||o.length===0?"":o.map(t=>typeof t=="number"?`[${t}]`:`.${t}`).join("").replace(/^\./,""),we=(o,t,n,c)=>{const d=o.map(g=>{let f;switch(g.type){case oe.NODE:f=n;break;case oe.ACCUMULATED:g.nodeId&&c[g.nodeId]&&(f=c[g.nodeId].outputData);break;case oe.CUSTOM:f=Se;break}let h=Me(f,g.path);return h!=null&&(typeof h=="object"?h=JSON.stringify(h):(typeof h=="boolean"||typeof h=="number")&&(h=String(h))),h}).filter(g=>g!=null);if(d.length!==0){if(d.length===1)return d[0];switch(t){case Y.ARRAY:return d;case Y.NEWLINE:return d.join(`
`);case Y.SPACE:return d.join(" ");case Y.COMMA:return d.join(",");default:return d[0]}}},Le=(o,t,n={},c=null)=>{const d=JSON.parse(JSON.stringify(o.exetool));if(d.arguments||(d.arguments={}),!o.fieldMappings||Object.keys(o.fieldMappings).length===0)return d;const g=Object.keys(o.fieldMappings)[0];if(g&&g.includes("-")&&g.length>20){if(c&&o.fieldMappings[c]){const h=o.fieldMappings[c];Object.entries(h).forEach(([_,i])=>{if(i.sources&&i.sources.length>0){const r=we(i.sources,i.mergeType||Y.ARRAY,t,n);r!==void 0&&(d.arguments[_]=r)}})}}else Object.entries(o.fieldMappings).forEach(([h,_])=>{if(Array.isArray(_)){const i=Me(t,_);i!==void 0&&(d.arguments[h]=i);return}if(_.sources&&_.sources.length>0){const i=we(_.sources,_.mergeType||Y.ARRAY,t,n);i!==void 0&&(d.arguments[h]=i)}});return d},ye=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const t=Math.random()*16|0;return(o==="x"?t:t&3|8).toString(16)}),_e=(o,t,n)=>{const c=n.x-o.x,d=n.y-o.y,g=Math.sqrt(c*c+d*d);if(g===0)return o;const f=t/g;return{x:o.x+c*f,y:o.y+d*f}},Ye=(o,t,n=48)=>{const c=o.position.x+n,d=o.position.y+n;switch(t){case"mapping":return{x:c,y:d-n};case"input":return{x:c-n,y:d};case"output":return{x:c+n,y:d};case"auto":return{x:c,y:d+n};default:return{x:c,y:d}}},K=De("workflowV3",()=>{const o=j([]),t=j(null),n=j({x:0,y:0}),c=j(1),d=j(!1),g=j({}),f=j({active:!1,sourceNodeId:null,sourcePortType:null,targetNodeId:null,targetPortType:null}),h=j({visible:!1,sourceNode:null,outputNodes:[],position:{}}),_=j(null),i=j({node:!0,accumulated:!0,custom:!0}),r=j({}),b=j(null),w=(s,u,p={x:100,y:100})=>{const m={id:ye(),toolKey:s,server:u.server,title:u.description||s,position:p,outputs:[],inputs:[],inputData:null,outputData:null,status:L.IDLE,nodeType:u.nodeType||"tool",fieldMappings:{},outputMappings:{},isStartNode:!1,exetool:{server:u.server,tool:u.tool,description:u.description,arguments:u.arguments}};return o.value.push(m),t.value=m.id,v(),m},x=(s={x:50,y:200})=>{const u={id:ye(),toolKey:"start",server:"system",title:"START",position:s,outputs:[],inputs:[],inputData:null,outputData:null,status:L.IDLE,nodeType:"start",fieldMappings:{},outputMappings:{},isStartNode:!0,exetool:null};return o.value.push(u),t.value=u.id,v(),u},y=s=>{const u=o.value.find(p=>p.id===s);u&&(u.isStartNode=!u.isStartNode,u.isStartNode&&(o.value.forEach(p=>{p.outputs=p.outputs.filter(m=>m!==s)}),u.inputs=[]))},v=()=>{o.value.forEach((s,u)=>{s.stepNumber=u+1})},O=(s,u)=>{const p=o.value.find(m=>m.id===s);p&&(p.position=u)},A=(s,u)=>{const p=o.value.find(m=>m.id===s);p&&(p.fieldMappings={...u},console.log("Store V3: 노드 매핑 업데이트됨",s,p.fieldMappings))},R=(s,u)=>{const p=o.value.find(m=>m.id===s);p&&(p.outputMappings={...u},console.log("Store V3: 노드 출력 매핑 업데이트됨",s,p.outputMappings))},Z=s=>{o.value.forEach(u=>{u.outputs=u.outputs.filter(p=>p!==s),u.inputs=u.inputs.filter(p=>p!==s)}),o.value=o.value.filter(u=>u.id!==s),t.value===s&&(t.value=null),v()},W=s=>{const u=o.value.find(m=>m.id===s);if(!u)return;const p={...JSON.parse(JSON.stringify(u)),id:ye(),position:{x:u.position.x+50,y:u.position.y+50},outputs:[],inputs:[],inputData:null,outputData:null,status:L.IDLE};return o.value.push(p),v(),p},H=s=>{const{nodeId:u,portType:p}=s;if(f.value.active){if(p!=="input"&&p!=="mapping"){console.warn("입력 포트를 선택하세요");return}re(f.value.sourceNodeId,u),f.value={active:!1,sourceNodeId:null,sourcePortType:null,targetNodeId:null,targetPortType:null}}else{if(p!=="output"&&p!=="auto"){console.warn("출력 포트를 먼저 선택하세요");return}f.value={active:!0,sourceNodeId:u,sourcePortType:p,targetNodeId:null,targetPortType:null},console.log("연결 모드 시작:",f.value)}},re=(s,u)=>{const p=o.value.find(S=>S.id===s),m=o.value.find(S=>S.id===u);return!p||!m||s===u||p.outputs.includes(u)?!1:m.isStartNode?(console.warn("START 노드에는 입력 연결을 할 수 없습니다"),!1):ge(s,u)?(console.warn("순환 참조가 발생합니다"),!1):(p.outputs.push(u),m.inputs.push(s),!0)},ce=(s,u)=>{const p=o.value.find(S=>S.id===s),m=o.value.find(S=>S.id===u);p&&(p.outputs=p.outputs.filter(S=>S!==u)),m&&(m.inputs=m.inputs.filter(S=>S!==s))},pe=s=>{const u=o.value.find(p=>p.id===s);u&&(u.outputs.forEach(p=>{const m=o.value.find(S=>S.id===p);m&&(m.inputs=m.inputs.filter(S=>S!==s))}),u.outputs=[])},ge=(s,u)=>{const p=new Set,m=S=>{if(S===s)return!0;if(p.has(S))return!1;p.add(S);const D=o.value.find(ee=>ee.id===S);if(!D)return!1;for(const ee of D.outputs)if(m(ee))return!0;return!1};return m(u)},Q=M(()=>{const s=[];return o.value.forEach(u=>{u.outputs.forEach(p=>{s.push({id:`${u.id}-${p}`,fromNodeId:u.id,toNodeId:p})})}),s}),fe=()=>{const s=o.value.filter(p=>p.isStartNode);return s.length===0?{valid:!1,message:"START 노드가 없습니다"}:s.filter(p=>p.outputs.length>0).length===0?{valid:!1,message:"START 노드가 연결되지 않았습니다"}:{valid:!0}},ve=async()=>{if(d.value)return;const s=fe();if(!s.valid){alert(s.message);return}d.value=!0,g.value={};try{const u=o.value.filter(p=>p.isStartNode);await Promise.all(u.map(p=>ne(p.id,null)))}finally{d.value=!1}},ne=async(s,u,p=null)=>{const m=o.value.find(S=>S.id===s);if(m){m.status=L.EXECUTING,m.inputData=u;try{if(m.isStartNode||m.nodeType==="start"){m.outputData=u,m.status=L.SUCCESS,m.outputs.length>0&&await Promise.all(m.outputs.map(B=>ne(B,u,s)));return}let S=m.fieldMappings,D="target.fieldMappings";if(p){const B=o.value.find(Ee=>Ee.id===p);B&&B.outputMappings&&B.outputMappings[s]&&(S={[p]:B.outputMappings[s]},D=`source[${B.title}].outputMappings[${m.title}]`,console.log(`🔀 출력 매핑 사용: ${B.title} → ${m.title}`))}console.log(`매핑 소스: ${D}`);const Ae={tool_calls:[Le({...m,fieldMappings:S},u,g.value,p)]},ue=await(await fetch(ze,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ae)})).json();m.outputData=ue,m.status=ue.error?L.ERROR:L.SUCCESS,g.value[s]={outputData:ue,status:m.status},m.outputs.length>0&&await Promise.all(m.outputs.map(B=>ne(B,ue,s)))}catch(S){m.status=L.ERROR,m.outputData={error:S.message}}}},xe=()=>{o.value.forEach(s=>{s.status=L.IDLE,s.inputData=null,s.outputData=null}),g.value={}},le=()=>{o.value=[],t.value=null,g.value={},f.value={active:!1,sourceNodeId:null,sourcePortType:null,targetNodeId:null,targetPortType:null}},me=s=>ke[s]||ke.system,ae=()=>({metadata:{version:"3.0",created:new Date().toISOString(),name:`workflow-${Date.now()}`},nodes:o.value.map(s=>({id:s.id,toolKey:s.toolKey,server:s.server,title:s.title,position:s.position,outputs:s.outputs,inputs:s.inputs,nodeType:s.nodeType,isStartNode:s.isStartNode,fieldMappings:s.fieldMappings,outputMappings:s.outputMappings,exetool:s.exetool})),connections:Q.value}),N=s=>!s||!s.nodes?(console.error("Invalid workflow data"),!1):(le(),s.nodes.forEach(u=>{const p={...u,status:L.IDLE,inputData:null,outputData:null};o.value.push(p)}),v(),!0),C=(s=null)=>{const u=ae(),p=JSON.stringify(u,null,2),m=new Blob([p],{type:"application/json"}),S=URL.createObjectURL(m),D=document.createElement("a");D.href=S,D.download=s||`${u.metadata.name}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(S)},T=s=>new Promise((u,p)=>{const m=new FileReader;m.onload=S=>{try{const D=JSON.parse(S.target.result),ee=N(D);u(ee)}catch(D){console.error("Failed to parse workflow file:",D),p(D)}},m.onerror=p,m.readAsText(s)}),U=(s,u,p)=>{h.value={visible:!0,sourceNode:s,outputNodes:u,position:p},s.outputMappings&&Object.keys(s.outputMappings).length>0?r.value=JSON.parse(JSON.stringify(s.outputMappings)):r.value={},u&&u.length>0&&(_.value=u[0].id),b.value=null},q=()=>{h.value={visible:!1,sourceNode:null,outputNodes:[],position:{}},r.value={},_.value=null,b.value=null},je=s=>{_.value=s},Oe=s=>{i.value[s]=!i.value[s]},ie=s=>(r.value[_.value]||(r.value[_.value]={}),r.value[_.value][s]||(r.value[_.value][s]={sources:[],mergeType:"array"}),r.value[_.value][s]);return{nodes:o,selectedNodeId:t,canvasOffset:n,canvasZoom:c,isExecuting:d,accumulatedData:g,connectionMode:f,mappingModal:h,activeTargetNode:_,openSources:i,localMappings:r,isDragOver:b,connections:Q,createNode:w,createStartNode:x,toggleStartNode:y,updateNodePosition:O,updateNodeMappings:A,updateNodeOutputMappings:R,deleteNode:Z,duplicateNode:W,handlePortClick:H,connect:re,disconnect:ce,disconnectAll:pe,executeChain:ve,resetExecution:xe,clearAll:le,getServerConfig:me,selectNode:s=>{t.value=s},clearSelection:()=>{t.value=null},exportWorkflow:ae,importWorkflow:N,downloadWorkflow:C,uploadWorkflow:T,openMappingModal:U,closeMappingModal:q,setActiveTargetNode:je,toggleSource:Oe,getCurrentParamMapping:ie,getCurrentParamSources:s=>ie(s).sources,addMappingSource:(s,u)=>{ie(s).sources.push(u)},removeMappingSource:(s,u)=>{const p=ie(s);p.sources.splice(u,1),p.sources.length===0&&delete r.value[_.value][s]},setDragOver:s=>{b.value=s},clearDragOver:()=>{b.value=null},hasMapping:s=>r.value[s]&&Object.keys(r.value[s]).length>0,getMappingCount:s=>r.value[s]?Object.keys(r.value[s]).length:0,getTotalMappingCount:()=>{let s=0;return Object.values(r.value).forEach(u=>{s+=Object.keys(u).length}),s},applyMappings:()=>{const s={};Object.entries(r.value).forEach(([u,p])=>{const m={};Object.entries(p).forEach(([S,D])=>{D.sources&&D.sources.length>0&&(m[S]=D)}),Object.keys(m).length>0&&(s[u]=m)}),h.value.sourceNode&&R(h.value.sourceNode.id,s),q()},getNodeTitle:s=>{const u=o.value.find(m=>m.id===s);if(!u)return s.substring(0,8);const p=u.stepNumber!==void 0?`#${u.stepNumber}`:"";return p?`${p} ${u.title}`:u.title},getSourceTypeLabel:s=>$e[s]||s,getSourceBadgeClass:s=>({node:"bg-blue-500/20 text-blue-700 dark:text-blue-300",accumulated:"bg-purple-500/20 text-purple-700 dark:text-purple-300",custom:"bg-orange-500/20 text-orange-700 dark:text-orange-300"})[s]||"bg-gray-500/20 text-gray-700",getDataKeyCount:s=>!s||typeof s!="object"?0:Object.keys(s).length,formatPath:Te}}),Fe={class:"rounded bg-popover px-2 py-0.5 text-[10px] font-bold text-popover-foreground shadow-lg"},We={__name:"WorkflowPortV3",props:{node:{type:Object,required:!0},portType:{type:String,required:!0,validator:o=>["mapping","input","output","auto"].includes(o)},isActive:{type:Boolean,default:!1},nodeRadius:{type:Number,default:48}},emits:["click"],setup(o,{emit:t}){const n=o,c=t,d=M(()=>Ie[n.portType]),g=M(()=>Ye(n.node,n.portType,n.nodeRadius)),f=M(()=>{const i=n.nodeRadius;let r,b;switch(n.portType){case"mapping":r=i,b=0;break;case"input":r=0,b=i;break;case"output":r=i*2,b=i;break;case"auto":r=i,b=i*2;break;default:r=i,b=i}return{left:`${r}px`,top:`${b}px`,transform:"translate(-50%, -50%)"}}),h=M(()=>{switch(n.portType){case"mapping":return"-top-6 left-1/2 -translate-x-1/2";case"input":return"left-0 -translate-x-full top-1/2 -translate-y-1/2 -ml-2";case"output":return"right-0 translate-x-full top-1/2 -translate-y-1/2 mr-2";case"auto":return"-bottom-6 left-1/2 -translate-x-1/2";default:return"-top-6"}}),_=()=>{c("click",{nodeId:n.node.id,portType:n.portType,position:g.value})};return(i,r)=>(l(),a("div",{class:E(["workflow-port absolute cursor-pointer transition-all",[o.isActive?"scale-125 ring-2 ring-white":"hover:scale-110",d.value.position]]),style:se(f.value),onClick:J(_,["stop"])},[e("div",{class:"size-4 rounded-full border-2 border-white shadow-lg",style:se({backgroundColor:d.value.color})},null,4),e("div",{class:E(["pointer-events-none absolute whitespace-nowrap opacity-0 transition-opacity hover:opacity-100",h.value])},[e("div",Fe,k(d.value.label),1)],2)],6))}},qe=F(We,[["__scopeId","data-v-3b9e17f4"]]),Ge={key:0,class:"absolute -top-6 left-1/2 -translate-x-1/2 rounded-full bg-yellow-500 px-2 py-0.5 text-xs font-bold text-white"},Je={class:"relative z-10 flex size-full flex-col items-center justify-center gap-1"},He={key:0,class:"size-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Xe={key:1,class:"size-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ke={key:2,class:"size-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ze={class:"pointer-events-none absolute -bottom-14 left-1/2 -translate-x-1/2 whitespace-nowrap rounded-lg px-3 py-1 text-xs text-popover-foreground transition-opacity group-hover:opacity-100"},Qe={__name:"WorkflowNodeV3",props:{node:{type:Object,required:!0},isSelected:{type:Boolean,default:!1},config:{type:Object,required:!0},connectionMode:{type:Object,default:()=>({active:!1})}},emits:["mousedown","contextmenu","portClick","addNext","showMappings"],setup(o,{emit:t}){const n=o,c=t,d=M(()=>n.node.isStartNode?[G.MAPPING,G.OUTPUT,G.AUTO]:Object.values(G)),g=M(()=>n.node.stepNumber||0),f=M(()=>n.node.outputMappings&&Object.keys(n.node.outputMappings).length>0),h=M(()=>({left:`${n.node.position.x}px`,top:`${n.node.position.y}px`})),_=M(()=>n.config.bgGradient),i=M(()=>{switch(n.node.status){case"executing":return"ring-4 ring-blue-500/70 transition duration-300 ease-out hover:ring-blue-600 shadow-[0_0_8px_4px_rgba(59,130,246,0.5)]";case"success":return"ring-4 ring-green-500/70 transition duration-300 ease-out hover:ring-green-600 shadow-[0_0_8px_4px_rgba(34,197,94,0.5)]";case"error":return"ring-4 ring-red-500/70 transition duration-300 ease-out hover:ring-red-600 shadow-[0_0_8px_4px_rgba(239,68,68,0.5)]";default:return"ring-4 ring-background transition duration-300 ease-out hover:ring-primary/30 shadow-[0_0_8px_4px_rgba(255,255,255,0.5)]"}}),r=M(()=>{switch(n.node.status){case"executing":return"bg-blue-500 text-white";case"success":return"bg-green-500 text-white";case"error":return"bg-red-500 text-white";default:return"bg-gray-500 text-white"}}),b=O=>{O.target.closest("button")||O.target.closest(".workflow-port")||c("mousedown",{node:n.node,event:O})},w=O=>{c("contextmenu",{node:n.node,event:O})},x=O=>{c("portClick",O)},y=()=>{c("addNext",n.node)},v=()=>{c("showMappings",n.node)};return(O,A)=>(l(),a("div",{class:E(["workflow-node-v3 absolute select-none",{"ring-4 ring-primary/50":o.isSelected}]),style:se(h.value),onMousedown:b,onContextmenu:J(w,["prevent"])},[o.node.isStartNode?(l(),a("div",Ge," START ")):P("",!0),e("div",{class:E(["relative size-24 cursor-move rounded-full",[i.value,{"scale-110":o.isSelected}]]),style:se({backgroundColor:o.config.color})},[e("div",{class:E(["absolute inset-0 rounded-full bg-gradient-to-br opacity-20",_.value])},null,2),e("div",Je,[e("div",{onClick:J(y,["stop"]),class:"flex items-center justify-center text-3xl font-extrabold transition-transform hover:scale-110 hover:text-primary/30"},k(o.config.icon),1),o.node.outputs&&o.node.outputs.length>0?(l(),a("div",{key:0,onClick:J(v,["stop"]),class:E(["cursor-pointer text-[10px] text-sm font-semibold text-white transition-colors",f.value?"text-primary":"text-muted-foreground"])},k(o.node.outputs.length)+" 맵핑 ",3)):P("",!0),A[0]||(A[0]=e("div",{class:"text-[10px] text-black"},null,-1))]),o.node.status!=="idle"?(l(),a("div",{key:0,class:E(["absolute -right-1 -top-1 flex size-6 items-center justify-center rounded-full",r.value])},[o.node.status==="executing"?(l(),a("svg",He,[...A[1]||(A[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):o.node.status==="success"?(l(),a("svg",Xe,[...A[2]||(A[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):o.node.status==="error"?(l(),a("svg",Ke,[...A[3]||(A[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])])):P("",!0)],2)):P("",!0)],6),(l(!0),a(z,null,I(d.value,R=>(l(),de(qe,{key:R,node:o.node,portType:R,isActive:o.connectionMode.active&&o.connectionMode.sourcePortType===R,onClick:x},null,8,["node","portType","isActive"]))),128)),e("div",Ze," #"+k(g.value)+" "+k(o.node.title),1)],38))}},et={class:"workflow-connections pointer-events-none absolute inset-0",style:{width:"100%",height:"100%"}},tt=["id","x1","y1","x2","y2"],ot=["stop-color"],st=["stop-color"],nt=["stop-color"],rt=["x1","y1","x2","y2","onClick"],lt=["x1","y1","x2","y2","stroke","stroke-width"],at=["x","y"],it=["fill"],ut=["x","y"],dt=["fill"],ct={key:0,class:"pointer-events-auto"},pt=["x","y"],gt=["onClick"],ft=["onClick"],vt={__name:"WorkflowConnectionV3",props:{connections:{type:Array,required:!0},nodes:{type:Array,required:!0},getNodeConfig:{type:Function,required:!0}},emits:["unlink","connectionClick","mapping"],setup(o,{emit:t}){const n=o,c=t,d=j(null),g=x=>n.nodes.find(y=>y.id===x),f=M(()=>{const x={};for(const y of n.connections){const v=g(y.fromNodeId),O=g(y.toNodeId);if(!v||!O){x[y.id]={line:{x1:0,y1:0,x2:0,y2:0},outputPort:{x:0,y:0},inputPort:{x:0,y:0}};continue}const A=Re.RADIUS,R={x:v.position.x+A,y:v.position.y+A},Z={x:O.position.x+A,y:O.position.y+A},W=_e(R,A+1,Z),H=_e(Z,A+1,R);x[y.id]={line:{x1:W.x,y1:W.y,x2:H.x,y2:H.y},outputPort:W,inputPort:H}}return x}),h=M(()=>{const x={};for(const y of n.connections){const v=f.value[y.id];x[y.id]={x:(v.line.x1+v.line.x2)/2,y:(v.line.y1+v.line.y2)/2}}return x}),_=x=>{const y=g(x.fromNodeId);return y?n.getNodeConfig(y.server).color:"#6b7280"},i=x=>{const y=g(x.toNodeId);return y?n.getNodeConfig(y.server).color:"#6b7280"},r=x=>{c("unlink",x),d.value=null},b=x=>{d.value===x.id?d.value=null:d.value=x.id,c("connectionClick",x)},w=x=>{c("mapping",x),d.value=null};return(x,y)=>(l(),a("svg",et,[e("defs",null,[(l(!0),a(z,null,I(o.connections,v=>(l(),a("linearGradient",{key:`grad-${v.id}`,id:`gradient-${v.id}`,x1:f.value[v.id].line.x1,y1:f.value[v.id].line.y1,x2:f.value[v.id].line.x2,y2:f.value[v.id].line.y2,gradientUnits:"userSpaceOnUse"},[e("stop",{offset:"0%","stop-color":_(v),"stop-opacity":"0.9"},null,8,ot),e("stop",{offset:"50%","stop-color":_(v),"stop-opacity":"0.7"},null,8,st),e("stop",{offset:"100%","stop-color":i(v),"stop-opacity":"0.9"},null,8,nt)],8,tt))),128))]),(l(!0),a(z,null,I(o.connections,v=>(l(),a("g",{key:v.id},[e("line",{x1:f.value[v.id].line.x1,y1:f.value[v.id].line.y1,x2:f.value[v.id].line.x2,y2:f.value[v.id].line.y2,stroke:"transparent","stroke-width":"20",class:"pointer-events-auto cursor-pointer",onClick:J(O=>b(v),["stop"])},null,8,rt),e("line",{x1:f.value[v.id].line.x1,y1:f.value[v.id].line.y1,x2:f.value[v.id].line.x2,y2:f.value[v.id].line.y2,stroke:`url(#gradient-${v.id})`,"stroke-width":d.value===v.id?8:4,"stroke-linecap":"round",class:"transition-all duration-200 ease-in-out"},null,8,lt),(l(),a("svg",{x:f.value[v.id].outputPort.x-25,y:f.value[v.id].outputPort.y-25,width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"pointer-events-auto"},[e("circle",{cx:"25",cy:"25",r:"22",fill:_(v),stroke:"white","stroke-width":"2.5"},null,8,it),y[2]||(y[2]=e("path",{d:"M10 30 l15 -15 l15 15",stroke:"white","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1))],8,at)),(l(),a("svg",{x:f.value[v.id].inputPort.x-25,y:f.value[v.id].inputPort.y-25,width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"pointer-events-auto"},[e("circle",{cx:"25",cy:"25",r:"22",fill:i(v),stroke:"white","stroke-width":"2.5"},null,8,dt)],8,ut)),d.value===v.id?(l(),a("g",ct,[(l(),a("foreignObject",{x:h.value[v.id].x-10,y:h.value[v.id].y-20,width:"140",height:"40",style:{overflow:"visible"}},[e("div",{class:"click-menu-container",onClick:y[1]||(y[1]=J(()=>{},["stop"]))},[e("button",{class:"unlink-btn flex size-8 cursor-pointer items-center justify-center rounded-full bg-red-500 text-white shadow-md hover:bg-red-600",onClick:O=>r(v),title:"Unlink"}," ✂ ",8,gt),e("button",{class:"mapping-btn ml-2 flex size-8 cursor-pointer items-center justify-center rounded-full bg-blue-500 text-white shadow-md hover:bg-blue-600",onClick:O=>w(v),title:"Mapping"}," 🔗 ",8,ft),e("button",{class:"close-btn ml-4 rounded bg-gray-300 px-2 py-1 text-sm hover:bg-gray-400",onClick:y[0]||(y[0]=O=>d.value=null),title:"Close Menu"}," ✕ ")])],8,pt))])):P("",!0)]))),128))]))}},xt=F(vt,[["__scopeId","data-v-b588a833"]]),mt={class:"mb-4 flex items-center justify-between"},bt={__name:"MappingModalHeader",emits:["close"],setup(o){return(t,n)=>(l(),a("div",mt,[n[2]||(n[2]=e("div",null,[e("h3",{class:"text-lg font-semibold text-foreground"},"다중 출력 노드 매핑"),e("p",{class:"mt-1 text-sm text-muted-foreground"},"각 출력 대상 노드별로 독립적인 매핑을 설정하세요")],-1)),e("button",{onClick:n[0]||(n[0]=c=>t.$emit("close")),class:"text-muted-foreground transition-colors hover:text-foreground"},[...n[1]||(n[1]=[e("svg",{class:"size-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]))}},yt={class:"mb-4 rounded-lg bg-muted/30 p-3"},ht={class:"flex items-center gap-2 font-medium text-foreground"},kt={class:"text-xs text-muted-foreground"},wt={__name:"SourceNodeInfoCard",props:{sourceNode:Object,outputCount:Number},setup(o){const t=o,n=M(()=>{if(!t.sourceNode)return"Unknown";const c=t.sourceNode.stepNumber!==void 0?`#${t.sourceNode.stepNumber}`:"";return c?`${c} ${t.sourceNode.title}`:t.sourceNode.title});return(c,d)=>(l(),a("div",yt,[d[0]||(d[0]=e("div",{class:"mb-1 text-xs text-muted-foreground"},"소스 노드 (출력 시작점)",-1)),e("div",ht,[e("span",null,k(n.value),1),e("span",kt,"→ "+k(o.outputCount)+"개 출력 대상",1)])]))}},_t={class:"mb-4 border-b border-border/30"},Ct={class:"flex gap-2 overflow-x-auto"},Nt=["onClick"],St={key:0,class:"rounded bg-primary/20 px-1.5 py-0.5 text-xs text-primary"},$t={__name:"TargetNodeTabs",props:{outputNodeIds:Array,activeNodeId:String},emits:["select"],setup(o){const t=K(),n=d=>t.getNodeTitle(d),c=d=>t.getMappingCount(d);return(d,g)=>(l(),a("div",_t,[e("div",Ct,[(l(!0),a(z,null,I(o.outputNodeIds,f=>(l(),a("button",{key:f,onClick:h=>d.$emit("select",f),class:E(["flex items-center gap-2 whitespace-nowrap px-4 py-2 text-sm font-medium transition-colors",o.activeNodeId===f?"border-b-2 border-primary text-foreground":"text-muted-foreground hover:text-foreground"])},[e("span",null,k(n(f)),1),c(f)>0?(l(),a("span",St,k(c(f)),1)):P("",!0)],10,Nt))),128))])]))}},Mt={class:"data-field-node"},Tt={key:0,class:"flex items-start gap-1"},jt={key:0,class:"size-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ot={key:1,class:"size-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},At={class:"text-xs font-medium text-primary"},Et={class:"text-xs text-muted-foreground"},Dt={class:"text-xs font-medium text-primary"},Pt={class:"max-w-[200px] truncate font-mono text-xs text-foreground"},Ut={key:2,class:"ml-4 mt-1 space-y-1 border-l-2 border-border/30 pl-2"},he={__name:"DataFieldNodeV3",props:{data:{type:[Object,Array,String,Number,Boolean,null],required:!0},path:{type:Array,default:()=>[]},sourceType:{type:String,required:!0,validator:o=>["node","accumulated","custom"].includes(o)},nodeId:{type:String,default:null}},setup(o){const t=o,n=j(!0),c=M(()=>typeof t.data=="object"&&t.data!==null),d=M(()=>{const i=t.path[t.path.length-1];return i===void 0?"root":typeof i=="number"?`[${i}]`:i}),g=M(()=>t.data===null?"null":Array.isArray(t.data)?`Array(${t.data.length})`:typeof t.data=="object"?`Object(${Object.keys(t.data).length})`:typeof t.data),f=M(()=>t.data===null?"null":t.data===void 0?"undefined":typeof t.data=="string"?`"${t.data}"`:typeof t.data=="boolean"||typeof t.data=="number"?t.data.toString():JSON.stringify(t.data)),h=()=>{n.value=!n.value},_=i=>{const r={sourceType:t.sourceType,nodeId:t.nodeId,path:t.path};i.dataTransfer.setData("application/json",JSON.stringify(r)),i.dataTransfer.effectAllowed="copy"};return(i,r)=>{const b=Ne("DataFieldNodeV3",!0);return l(),a("div",Mt,[c.value?(l(),a("div",Tt,[e("button",{onClick:h,class:"mt-0.5 flex size-4 items-center justify-center text-muted-foreground transition-colors hover:text-foreground"},[n.value?(l(),a("svg",jt,[...r[0]||(r[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])])):(l(),a("svg",Ot,[...r[1]||(r[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])]))]),e("div",{class:"flex cursor-move items-center gap-1 rounded px-1 py-0.5 transition-colors hover:bg-accent/50",draggable:"true",onDragstart:_},[e("span",At,k(d.value),1),e("span",Et,k(g.value),1)],32)])):(l(),a("div",{key:1,class:"flex cursor-move items-center gap-1 rounded px-1 py-0.5 transition-colors hover:bg-accent/50",draggable:"true",onDragstart:_},[e("span",Dt,k(d.value),1),r[2]||(r[2]=e("span",{class:"text-xs text-muted-foreground"},":",-1)),e("span",Pt,k(f.value),1)],32)),n.value&&c.value?(l(),a("div",Ut,[(l(!0),a(z,null,I(o.data,(w,x)=>(l(),de(b,{key:x,data:w,path:[...o.path,x],sourceType:o.sourceType,nodeId:o.nodeId},null,8,["data","path","sourceType","nodeId"]))),128))])):P("",!0)])}}},Vt={class:"max-h-[500px] space-y-3 overflow-auto"},zt={class:"overflow-hidden rounded-lg border border-border/30 bg-background/50"},It={class:"flex items-center gap-2"},Rt={class:"text-sm font-medium text-foreground"},Bt={key:0,class:"rounded bg-blue-500/20 px-2 py-0.5 text-xs text-blue-700 dark:text-blue-300"},Lt={class:"max-h-[200px] overflow-auto p-4 pt-0"},Yt={key:0},Ft={key:1,class:"text-xs italic text-muted-foreground"},Wt={class:"overflow-hidden rounded-lg border border-border/30 bg-background/50"},qt={class:"flex items-center gap-2"},Gt={key:0,class:"rounded bg-purple-500/20 px-2 py-0.5 text-xs text-purple-700 dark:text-purple-300"},Jt={class:"max-h-[200px] overflow-auto p-4 pt-0"},Ht={key:0},Xt={key:1,class:"text-xs italic text-muted-foreground"},Kt={class:"overflow-hidden rounded-lg border border-border/30 bg-background/50"},Zt={class:"flex items-center gap-2"},Qt={class:"rounded bg-orange-500/20 px-2 py-0.5 text-xs text-orange-700 dark:text-orange-300"},eo={class:"max-h-[200px] overflow-auto p-4 pt-0"},to={__name:"DataSourceAccordion",props:{sourceNode:Object,accumulatedData:Object},setup(o){const t=o,n=K(),c=M(()=>n.openSources),d=M(()=>{var i;return((i=t.sourceNode)==null?void 0:i.outputData)||null}),g=Se,f=M(()=>{if(!t.sourceNode)return"Unknown";const i=t.sourceNode.stepNumber!==void 0?`#${t.sourceNode.stepNumber}`:"";return i?`${i} ${t.sourceNode.title}`:t.sourceNode.title}),h=i=>{n.toggleSource(i)},_=i=>n.getDataKeyCount(i);return(i,r)=>(l(),a("div",null,[r[11]||(r[11]=e("div",{class:"mb-2 text-sm font-medium text-foreground"},"데이터 소스 선택",-1)),e("div",Vt,[e("div",zt,[e("button",{onClick:r[0]||(r[0]=b=>h("node")),class:"flex w-full items-center justify-between px-4 py-3 transition-colors hover:bg-muted/30"},[e("div",It,[r[3]||(r[3]=e("span",{class:"text-lg"},"📤",-1)),e("span",Rt,k(f.value)+" 출력",1),d.value?(l(),a("span",Bt,k(_(d.value))+" keys ",1)):P("",!0)]),(l(),a("svg",{class:E(["size-4 transition-transform",c.value.node&&"rotate-180"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[4]||(r[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),X(e("div",Lt,[d.value?(l(),a("div",Yt,[V(he,{data:d.value,path:[],sourceType:"node",nodeId:o.sourceNode.id},null,8,["data","nodeId"])])):(l(),a("div",Ft,"노드 실행 후 데이터가 표시됩니다"))],512),[[te,c.value.node]])]),e("div",Wt,[e("button",{onClick:r[1]||(r[1]=b=>h("accumulated")),class:"flex w-full items-center justify-between px-4 py-3 transition-colors hover:bg-muted/30"},[e("div",qt,[r[5]||(r[5]=e("span",{class:"text-lg"},"💾",-1)),r[6]||(r[6]=e("span",{class:"text-sm font-medium text-foreground"},"누적 데이터",-1)),Object.keys(o.accumulatedData).length>0?(l(),a("span",Gt,k(Object.keys(o.accumulatedData).length)+" nodes ",1)):P("",!0)]),(l(),a("svg",{class:E(["size-4 transition-transform",c.value.accumulated&&"rotate-180"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[7]||(r[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),X(e("div",Jt,[Object.keys(o.accumulatedData).length>0?(l(),a("div",Ht,[V(he,{data:o.accumulatedData,path:[],sourceType:"accumulated"},null,8,["data"])])):(l(),a("div",Xt,"누적 데이터가 없습니다"))],512),[[te,c.value.accumulated]])]),e("div",Kt,[e("button",{onClick:r[2]||(r[2]=b=>h("custom")),class:"flex w-full items-center justify-between px-4 py-3 transition-colors hover:bg-muted/30"},[e("div",Zt,[r[8]||(r[8]=e("span",{class:"text-lg"},"⚙️",-1)),r[9]||(r[9]=e("span",{class:"text-sm font-medium text-foreground"},"Custom Dataset",-1)),e("span",Qt,k(Object.keys($(g)).length)+" categories ",1)]),(l(),a("svg",{class:E(["size-4 transition-transform",c.value.custom&&"rotate-180"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[10]||(r[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),X(e("div",eo,[V(he,{data:$(g),path:[],sourceType:"custom"},null,8,["data"])],512),[[te,c.value.custom]])])])]))}},oo=F(to,[["__scopeId","data-v-b9f65a61"]]),so={__name:"DropZoneComponent",props:{paramName:String},emits:["drop"],setup(o,{emit:t}){const n=o,c=t,d=K(),g=j(!1),f=i=>{i.preventDefault(),g.value=!0,d.setDragOver(n.paramName)},h=i=>{i.currentTarget.contains(i.relatedTarget)||(g.value=!1,d.clearDragOver())},_=i=>{g.value=!1,d.clearDragOver();try{const r=JSON.parse(i.dataTransfer.getData("application/json")),b={type:r.sourceType,path:r.path};(r.sourceType==="node"||r.sourceType==="accumulated")&&(b.nodeId=r.nodeId),d.addMappingSource(n.paramName,b),c("drop",{paramName:n.paramName,source:b})}catch(r){console.error("드래그 데이터 파싱 실패:",r)}};return(i,r)=>(l(),a("div",{onDragover:J(f,["prevent"]),onDragleave:h,onDrop:_,class:E(["w-full rounded-lg border-2 border-dashed p-3 text-center text-sm transition-all",g.value?"scale-105 border-solid border-accent bg-accent/30":"border-primary/30 bg-primary/5 hover:border-primary/50 hover:bg-primary/10"])},[e("span",{class:E(g.value?"text-accent-foreground font-medium":"text-primary")},k(g.value?"🎯 여기에 드롭하세요!":"+ 키를 드래그하여 드롭"),3)],34))}},no={class:"mb-2 text-sm font-medium text-foreground"},ro={class:"max-h-[570px] space-y-3 overflow-auto"},lo={class:"mb-2 flex items-center justify-between"},ao={class:"text-sm font-medium text-foreground"},io={class:"text-xs text-muted-foreground"},uo={class:"space-y-2"},co={class:"flex-1 truncate font-mono text-xs text-foreground"},po=["onClick"],go={key:0,class:"mt-3 border-t border-border/30 pt-3"},fo=["onUpdate:modelValue"],vo={__name:"ParameterMappingPanel",props:{targetNode:Object,sourceNodeTitle:String},setup(o){const t=o,n=K(),c=M(()=>{var b,w;return(w=(b=t.targetNode)==null?void 0:b.exetool)!=null&&w.arguments?Object.entries(t.targetNode.exetool.arguments).map(([x,y])=>({name:x,type:y.type||"string",description:y.description,required:y.required})):[]}),d=M(()=>{var b;return n.getNodeTitle((b=t.targetNode)==null?void 0:b.id)}),g=b=>n.getCurrentParamSources(b),f=b=>n.getCurrentParamMapping(b),h=(b,w)=>{n.removeMappingSource(b,w)},_=b=>n.getSourceTypeLabel(b),i=b=>n.getSourceBadgeClass(b),r=b=>n.formatPath(b);return(b,w)=>(l(),a("div",null,[e("div",no,k(o.sourceNodeTitle)+" → "+k(d.value)+" 파라미터 매핑 ",1),e("div",ro,[(l(!0),a(z,null,I(c.value,x=>(l(),a("div",{key:x.name,class:"rounded-lg border-2 border-dashed border-border/50 bg-muted/30 p-3"},[e("div",lo,[e("div",null,[e("div",ao,k(x.name),1),e("div",io,k(x.description||x.type),1)])]),e("div",uo,[(l(!0),a(z,null,I(g(x.name),(y,v)=>(l(),a("div",{key:v,class:"flex items-center gap-2 rounded border border-border/30 bg-background/50 p-2"},[e("div",{class:E([i(y.type),"whitespace-nowrap rounded px-2 py-0.5 text-xs font-medium"])},k(_(y.type)),3),e("div",co,k(r(y.path)),1),e("button",{onClick:O=>h(x.name,v),class:"text-destructive transition-colors hover:text-destructive/80"},[...w[0]||(w[0]=[e("svg",{class:"size-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,po)]))),128)),V(so,{paramName:x.name},null,8,["paramName"])]),g(x.name).length>1?(l(),a("div",go,[w[2]||(w[2]=e("label",{class:"mb-1 block text-xs font-medium text-foreground"},"병합 방식",-1)),X(e("select",{"onUpdate:modelValue":y=>f(x.name).mergeType=y,class:"w-full rounded border border-border bg-background px-2 py-1 text-sm"},[...w[1]||(w[1]=[e("option",{value:"array"},"배열로 병합 [a, b, c]",-1),e("option",{value:"newline"},"줄바꿈으로 병합 (a\\nb\\nc)",-1),e("option",{value:"space"},"공백으로 병합 (a b c)",-1),e("option",{value:"comma"},"쉼표로 병합 (a,b,c)",-1)])],8,fo),[[Pe,f(x.name).mergeType]])])):P("",!0)]))),128))])]))}},xo=F(vo,[["__scopeId","data-v-dbe1fd5b"]]),mo={class:"flex items-center justify-between gap-2 border-t border-border/30 pt-4"},bo={class:"text-xs text-muted-foreground"},yo={class:"flex gap-2"},ho=["disabled"],ko={__name:"MappingFooter",props:{outputCount:Number,totalMappingCount:Number},emits:["cancel","apply"],setup(o){return(t,n)=>(l(),a("div",mo,[e("div",bo," ✨ 출력 대상 "+k(o.outputCount)+"개 • 총 매핑 "+k(o.totalMappingCount)+"개 ",1),e("div",yo,[e("button",{onClick:n[0]||(n[0]=c=>t.$emit("cancel")),class:"rounded-lg bg-muted px-4 py-2 text-sm text-muted-foreground transition-colors hover:bg-muted/80"}," 취소 "),e("button",{onClick:n[1]||(n[1]=c=>t.$emit("apply")),disabled:o.totalMappingCount===0,class:"rounded-lg bg-primary px-4 py-2 text-sm text-primary-foreground transition-colors hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-50"}," 적용 ("+k(o.totalMappingCount)+") ✓ ",9,ho)])]))}},wo={key:0,class:"mb-4 grid grid-cols-2 gap-6"},_o={__name:"DataFieldMapperV3_MultiInput_New",setup(o){const t=K(),n=M(()=>{var g;return((g=t.mappingModal.outputNodes)==null?void 0:g.map(f=>f.id))||[]}),c=M(()=>{var g;return t.activeTargetNode?(g=t.mappingModal.outputNodes)==null?void 0:g.find(f=>f.id===t.activeTargetNode):null}),d=M(()=>{const g=t.mappingModal.sourceNode;if(!g)return"Unknown";const f=g.stepNumber!==void 0?`#${g.stepNumber}`:"";return f?`${f} ${g.title}`:g.title});return(g,f)=>$(t).mappingModal.visible?(l(),a("div",{key:0,class:"absolute z-50 min-w-[1200px] max-w-[1200px] rounded-2xl border border-border/30 bg-card/95 p-6 shadow-2xl backdrop-blur-xl",style:se($(t).mappingModal.position)},[V(bt,{onClose:$(t).closeMappingModal},null,8,["onClose"]),V(wt,{sourceNode:$(t).mappingModal.sourceNode,outputCount:n.value.length},null,8,["sourceNode","outputCount"]),V($t,{outputNodeIds:n.value,activeNodeId:$(t).activeTargetNode,onSelect:$(t).setActiveTargetNode},null,8,["outputNodeIds","activeNodeId","onSelect"]),$(t).activeTargetNode?(l(),a("div",wo,[V(oo,{sourceNode:$(t).mappingModal.sourceNode,accumulatedData:$(t).accumulatedData},null,8,["sourceNode","accumulatedData"]),V(xo,{targetNode:c.value,sourceNodeTitle:d.value},null,8,["targetNode","sourceNodeTitle"])])):P("",!0),V(ko,{outputCount:n.value.length,totalMappingCount:$(t).getTotalMappingCount(),onCancel:$(t).closeMappingModal,onApply:$(t).applyMappings},null,8,["outputCount","totalMappingCount","onCancel","onApply"])],4)):P("",!0)}},Co=F(_o,[["__scopeId","data-v-6545f3e0"]]),No={class:"text-lg"},So={__name:"ContextMenu",props:{visible:{type:Boolean,default:!1},node:{type:Object,default:null},position:{type:Object,default:()=>({x:0,y:0})}},emits:["toggleStart","duplicate","removeAllConnections","delete","close"],setup(o,{emit:t}){const n=o,c=t,d=M(()=>({left:`${n.position.x}px`,top:`${n.position.y}px`})),g=()=>{c("toggleStart",n.node),c("close")},f=()=>{c("duplicate",n.node),c("close")},h=()=>{confirm("이 노드의 모든 연결을 제거하시겠습니까?")&&(c("removeAllConnections",n.node),c("close"))},_=()=>{var i;confirm(`"${(i=n.node)==null?void 0:i.title}" 노드를 삭제하시겠습니까?`)&&(c("delete",n.node),c("close"))};return(i,r)=>o.visible?(l(),a("div",{key:0,class:"fixed z-50 min-w-[200px] rounded-lg border border-border/30 bg-card/95 p-2 shadow-2xl backdrop-blur-xl",style:se(d.value)},[e("button",{onClick:g,class:"flex w-full items-center gap-2 rounded px-3 py-2 text-left text-sm transition-colors hover:bg-accent"},[e("span",No,k(o.node.isStartNode?"✅":"⭕"),1),e("span",null,k(o.node.isStartNode?"START 해제":"START 설정"),1)]),r[3]||(r[3]=e("div",{class:"my-1 border-t border-border/30"},null,-1)),e("button",{onClick:f,class:"flex w-full items-center gap-2 rounded px-3 py-2 text-left text-sm transition-colors hover:bg-accent"},[...r[0]||(r[0]=[e("span",{class:"text-lg"},"📋",-1),e("span",null,"노드 복제",-1)])]),r[4]||(r[4]=e("div",{class:"my-1 border-t border-border/30"},null,-1)),e("button",{onClick:h,class:"flex w-full items-center gap-2 rounded px-3 py-2 text-left text-sm transition-colors hover:bg-accent"},[...r[1]||(r[1]=[e("span",{class:"text-lg"},"🔗",-1),e("span",null,"모든 연결 제거",-1)])]),r[5]||(r[5]=e("div",{class:"my-1 border-t border-border/30"},null,-1)),e("button",{onClick:_,class:"flex w-full items-center gap-2 rounded px-3 py-2 text-left text-sm text-destructive transition-colors hover:bg-destructive/20"},[...r[2]||(r[2]=[e("span",{class:"text-lg"},"🗑️",-1),e("span",null,"노드 삭제",-1)])])],4)):P("",!0)}},$o={class:"json-viewer-node"},Mo={key:0,class:"flex flex-col"},To={class:"flex items-start gap-1"},jo={key:0,class:"size-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Oo={key:1,class:"size-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ao={class:"flex min-w-0 flex-1 items-center gap-1"},Eo={class:"text-xs font-medium text-primary"},Do={class:"text-xs text-muted-foreground"},Po={class:"ml-4 mt-1 space-y-1 border-l-2 border-border/20 pl-2"},Uo={key:1,class:"flex items-center gap-2"},Vo={class:"text-xs font-medium text-primary"},zo={__name:"JsonViewerNode",props:{keyName:{type:[String,Number],required:!0},value:{type:[Object,Array,String,Number,Boolean,null],required:!0},level:{type:Number,default:0}},setup(o){const t=o,n=j(t.level<33),c=M(()=>typeof t.value=="object"&&t.value!==null),d=M(()=>typeof t.keyName=="number"?`[${t.keyName}]`:t.keyName),g=M(()=>t.value===null?"null":Array.isArray(t.value)?`Array(${t.value.length})`:typeof t.value=="object"?`Object(${Object.keys(t.value).length})`:typeof t.value),f=M(()=>t.value===null?"null":t.value===void 0?"undefined":typeof t.value=="string"?`"${t.value}"`:typeof t.value=="boolean"||typeof t.value=="number"?t.value.toString():JSON.stringify(t.value)),h=()=>{n.value=!n.value},_=i=>i===null?"text-muted-foreground":typeof i=="string"?"text-green-600 dark:text-green-400":typeof i=="number"?"text-blue-600 dark:text-blue-400":typeof i=="boolean"?"text-purple-600 dark:text-purple-400":"text-foreground";return(i,r)=>{const b=Ne("JsonViewerNode",!0);return l(),a("div",$o,[c.value?(l(),a("div",Mo,[e("div",To,[e("button",{onClick:h,class:"mt-0.5 flex size-4 shrink-0 items-center justify-center text-muted-foreground transition-colors hover:text-foreground"},[n.value?(l(),a("svg",jo,[...r[0]||(r[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])])):(l(),a("svg",Oo,[...r[1]||(r[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])]))]),e("div",Ao,[e("span",Eo,k(d.value)+":",1),e("span",Do,k(g.value),1)])]),X(e("div",Po,[(l(!0),a(z,null,I(o.value,(w,x)=>(l(),de(b,{key:x,keyName:x,value:w,level:o.level+1},null,8,["keyName","value","level"]))),128))],512),[[te,n.value]])])):(l(),a("div",Uo,[e("span",Vo,k(d.value)+":",1),e("span",{class:E([_(o.value),"break-all font-mono text-xs"])},k(f.value),3)]))])}}},Io=F(zo,[["__scopeId","data-v-d2989fce"]]),Ro={class:"json-viewer"},Bo={key:0,class:"json-object"},Lo={class:"mb-2 flex items-center gap-1"},Yo={key:0,class:"size-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Fo={key:1,class:"size-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Wo={class:"text-xs text-muted-foreground"},qo={class:"ml-4 space-y-1"},Go={key:1,class:"json-value"},Jo={__name:"JsonViewer",props:{data:{type:[Object,Array,String,Number,Boolean,null],required:!0},level:{type:Number,default:0}},setup(o){const t=o,n=j(t.level<23),c=i=>i!==null&&typeof i=="object",d=i=>Array.isArray(i),g=()=>{n.value=!n.value},f=i=>i===null?"text-muted-foreground":typeof i=="string"?"text-green-600 dark:text-green-400":typeof i=="number"?"text-blue-600 dark:text-blue-400":typeof i=="boolean"?"text-purple-600 dark:text-purple-400":"text-foreground",h=i=>i===null?"null":i===void 0?"undefined":typeof i=="string"?`"${i}"`:String(i),_=async()=>{try{const i=JSON.stringify(t.data,null,2);await navigator.clipboard.writeText(i)}catch(i){console.error("클립보드 복사 실패:",i)}};return(i,r)=>(l(),a("div",Ro,[c(o.data)?(l(),a("div",Bo,[e("div",Lo,[e("button",{onClick:g,class:"flex size-4 items-center justify-center text-muted-foreground transition-colors hover:text-foreground"},[n.value?(l(),a("svg",Yo,[...r[0]||(r[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])])):(l(),a("svg",Fo,[...r[1]||(r[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])]))]),e("span",Wo,k(d(o.data)?`Array(${o.data.length})`:`Object(${Object.keys(o.data).length})`),1),e("button",{onClick:_,class:"ml-auto text-muted-foreground transition-colors hover:text-foreground",title:"클립보드에 복사"},[...r[2]||(r[2]=[e("svg",{class:"size-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])])]),X(e("div",qo,[(l(!0),a(z,null,I(o.data,(b,w)=>(l(),a("div",{key:w,class:"json-entry"},[V(Io,{keyName:w,value:b,level:o.level+1},null,8,["keyName","value","level"])]))),128))],512),[[te,n.value]])])):(l(),a("div",Go,[e("span",{class:E(f(o.data))},k(h(o.data)),3),e("button",{onClick:_,class:"ml-2 text-muted-foreground transition-colors hover:text-foreground",title:"클립보드에 복사"},[...r[3]||(r[3]=[e("svg",{class:"size-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])])]))]))}},Ce=F(Jo,[["__scopeId","data-v-30ea67ac"]]),Ho={class:"workflow-data-viewer flex h-full flex-col bg-background"},Xo={class:"flex-1 overflow-auto"},Ko={key:0,class:"flex h-full items-center justify-center"},Zo={key:1,class:"space-y-3 p-4"},Qo=["onClick"],es={class:"flex items-center gap-3"},ts={class:"text-left"},os={class:"text-sm font-medium text-foreground"},ss={class:"text-xs text-muted-foreground"},ns={class:"border-t border-border/30"},rs={class:"flex border-b border-border/30 bg-muted/20"},ls=["onClick"],as={class:"p-4"},is={key:0},us={key:0},ds={key:1,class:"text-xs italic text-muted-foreground"},cs={key:1},ps={key:0},gs={key:1,class:"text-xs italic text-muted-foreground"},fs={key:2},vs={key:0},xs={class:"space-y-2"},ms={class:"mb-1 text-xs font-medium text-foreground"},bs={key:0,class:"space-y-1"},ys={class:"font-mono text-muted-foreground"},hs={key:0,class:"text-xs text-muted-foreground"},ks={key:1,class:"text-xs italic text-muted-foreground"},ws={__name:"WorkflowDataViewer",setup(o){const t=K(),n=j(new Set),c=j({}),d=M(()=>t.nodes.filter(w=>w.status!=="idle")),g=w=>{n.value.has(w)?n.value.delete(w):(n.value.add(w),c.value[w]||(c.value[w]="output"))},f=w=>({idle:"bg-muted",executing:"bg-blue-500 animate-pulse",success:"bg-green-500",error:"bg-red-500"})[w]||"bg-muted",h=w=>({input:"입력 데이터",output:"출력 데이터",mappings:"필드 매핑"})[w]||w,_=w=>$e[w]||w,i=w=>({node:"bg-blue-500/20 text-blue-700 dark:text-blue-300",accumulated:"bg-purple-500/20 text-purple-700 dark:text-purple-300",custom:"bg-orange-500/20 text-orange-700 dark:text-orange-300"})[w]||"bg-gray-500/20 text-gray-700",r=w=>Be[w]||w,b=()=>{n.value=new Set(n.value)};return Ue(()=>t.isExecuting,w=>{if(!w&&d.value.length>0){const x=d.value[0];x&&!n.value.has(x.id)&&g(x.id)}}),(w,x)=>(l(),a("div",Ho,[e("div",{class:"border-b border-border/30 px-4 py-3"},[e("div",{class:"flex items-center justify-between"},[x[1]||(x[1]=e("div",null,[e("h3",{class:"text-sm font-semibold text-foreground"},"노드 데이터 뷰어"),e("p",{class:"mt-0.5 text-xs text-muted-foreground"},"실행된 노드의 입출력 데이터를 확인하세요")],-1)),e("div",{class:"flex items-center gap-2"},[e("button",{onClick:b,class:"text-muted-foreground transition-colors hover:text-foreground",title:"새로고침"},[...x[0]||(x[0]=[e("svg",{class:"size-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])])])])]),e("div",Xo,[d.value.length===0?(l(),a("div",Ko,[...x[2]||(x[2]=[Ve('<div class="text-center text-muted-foreground" data-v-5228a06d><svg class="mx-auto mb-3 size-16 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-5228a06d><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-5228a06d></path></svg><p class="text-sm font-medium" data-v-5228a06d>실행된 노드가 없습니다</p><p class="mt-1 text-xs" data-v-5228a06d>워크플로우를 실행하면 데이터가 표시됩니다</p></div>',1)])])):(l(),a("div",Zo,[(l(!0),a(z,null,I(d.value,y=>(l(),a("div",{key:y.id,class:"overflow-hidden rounded-lg border border-border/30 bg-card"},[e("button",{onClick:v=>g(y.id),class:"flex w-full items-center justify-between px-4 py-3 transition-colors hover:bg-muted/30"},[e("div",es,[e("div",{class:E([f(y.status),"size-2 rounded-full"])},null,2),e("div",ts,[e("div",os,k(y.title),1),e("div",ss,k(y.toolKey)+" • Step #"+k(y.stepNumber),1)])]),(l(),a("svg",{class:E(["size-4 transition-transform",n.value.has(y.id)&&"rotate-180"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...x[3]||(x[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,Qo),X(e("div",ns,[e("div",rs,[(l(),a(z,null,I(["input","output","mappings"],v=>e("button",{key:v,onClick:O=>c.value[y.id]=v,class:E(["flex-1 px-4 py-2 text-xs font-medium transition-colors",c.value[y.id]===v?"border-b-2 border-primary bg-background text-foreground":"text-muted-foreground hover:bg-muted/30 hover:text-foreground"])},k(h(v)),11,ls)),64))]),e("div",as,[c.value[y.id]==="input"?(l(),a("div",is,[y.inputData?(l(),a("div",us,[V(Ce,{data:y.inputData},null,8,["data"])])):(l(),a("div",ds,"입력 데이터 없음"))])):P("",!0),c.value[y.id]==="output"?(l(),a("div",cs,[y.outputData?(l(),a("div",ps,[V(Ce,{data:y.outputData},null,8,["data"])])):(l(),a("div",gs,"출력 데이터 없음"))])):P("",!0),c.value[y.id]==="mappings"?(l(),a("div",fs,[y.fieldMappings&&Object.keys(y.fieldMappings).length>0?(l(),a("div",vs,[e("div",xs,[(l(!0),a(z,null,I(y.fieldMappings,(v,O)=>(l(),a("div",{key:O,class:"rounded bg-muted/30 p-2"},[e("div",ms,k(O),1),v.sources?(l(),a("div",bs,[(l(!0),a(z,null,I(v.sources,(A,R)=>(l(),a("div",{key:R,class:"flex items-center gap-2 text-xs"},[e("span",{class:E([i(A.type),"rounded px-2 py-0.5"])},k(_(A.type)),3),e("span",ys,k($(Te)(A.path)),1)]))),128)),v.sources.length>1?(l(),a("div",hs," 병합: "+k(r(v.mergeType)),1)):P("",!0)])):P("",!0)]))),128))])])):(l(),a("div",ks,"필드 매핑 없음"))])):P("",!0)])],512),[[te,n.value.has(y.id)]])]))),128))]))])]))}},_s=F(ws,[["__scopeId","data-v-5228a06d"]]),Cs={class:"workflow-view-v3 flex h-full flex-col bg-background"},Ns={class:"flex items-center justify-between border-b border-border/30 bg-card/50 px-6 py-4 backdrop-blur-xl"},Ss={class:"flex items-center gap-2"},$s=["disabled"],Ms={key:0,class:"size-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ts={key:1,class:"size-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},js=["disabled"],Os={class:"flex flex-1 overflow-hidden"},As={class:"absolute left-4 top-[600px] max-w-xs rounded-2xl border border-border/30 bg-card/95 p-4 shadow-2xl backdrop-blur-xl"},Es={class:"max-h-[400px] space-y-2 overflow-y-auto"},Ds=["onClick"],Ps={class:"text-lg"},Us={class:"min-w-0 flex-1"},Vs={class:"truncate font-medium text-foreground"},zs={class:"text-xs text-muted-foreground"},Is={key:0,class:"flex-1 border-l border-border/30 bg-card/50"},Rs=["title"],Bs={class:"text-sm"},Ls={class:"mx-4 max-h-[80vh] w-full max-w-2xl overflow-auto rounded-2xl border border-border/30 bg-card/95 p-6 shadow-2xl backdrop-blur-xl"},Ys={class:"grid grid-cols-2 gap-3"},Fs=["onClick"],Ws={class:"flex items-center gap-3"},qs={class:"text-2xl"},Gs={class:"min-w-0 flex-1"},Js={class:"font-medium text-foreground"},Hs={class:"mt-1 text-xs text-muted-foreground"},Xs={__name:"WorkflowViewV3",setup(o){const t=K(),n=j(null),c=j(null),d=j({}),g=j(!1),f=j(!1),h=j(null),_=j({x:0,y:0}),i=j(!1),r=j(null),b=j({isDragging:!1,node:null,startX:0,startY:0,nodeStartX:0,nodeStartY:0});(async()=>{try{const C=await(await fetch("/statics/chart/quickExamples.json")).json();d.value=C}catch(N){console.error("Failed to load quickExamples.json:",N),d.value={}}})();const x=()=>{const N={x:100+t.nodes.length*50,y:200};t.createStartNode(N)},y=(N,C)=>{const T={x:400+t.nodes.length*50,y:150+t.nodes.length*30};t.createNode(N,C,T)},v=({node:N,event:C})=>{b.value={isDragging:!0,node:N,startX:C.clientX,startY:C.clientY,nodeStartX:N.position.x,nodeStartY:N.position.y}},O=()=>{t.clearSelection(),W()},A=N=>{if(!b.value.isDragging||!b.value.node)return;const C=N.clientX-b.value.startX,T=N.clientY-b.value.startY,U=b.value.nodeStartX+C,q=b.value.nodeStartY+T;t.updateNodePosition(b.value.node.id,{x:U,y:q})},R=()=>{b.value={isDragging:!1,node:null,startX:0,startY:0,nodeStartX:0,nodeStartY:0}},Z=({node:N,event:C})=>{h.value=N,_.value={x:C.clientX,y:C.clientY},f.value=!0},W=()=>{f.value=!1,h.value=null},H=N=>{t.toggleStartNode(N.id)},re=N=>{t.duplicateNode(N.id)},ce=N=>{t.disconnectAll(N.id)},pe=N=>{t.deleteNode(N.id)},ge=N=>{r.value=N,i.value=!0},Q=()=>{i.value=!1,r.value=null},fe=(N,C)=>{if(!r.value)return;const T={x:r.value.position.x,y:r.value.position.y+150},U=t.createNode(N,C,T);t.connect(r.value.id,U.id),Q()},ve=N=>{if(N.outputs&&N.outputs.length>0){const C=N.outputs.map(U=>t.nodes.find(q=>q.id===U)).filter(U=>U!=null),T={left:"50%",top:"50%",transform:"translate(-50%, -50%)"};t.openMappingModal(N,C,T);return}alert("출력 연결이 없습니다.")},ne=N=>{t.disconnect(N.fromNodeId,N.toNodeId)},xe=async()=>{await t.executeChain()},le=()=>{t.downloadWorkflow(),console.log("워크플로우 저장 완료")},me=()=>{var N;(N=c.value)==null||N.click()},ae=async N=>{var T;const C=(T=N.target.files)==null?void 0:T[0];if(C)try{await t.uploadWorkflow(C),console.log("워크플로우 불러오기 완료"),N.target.value=""}catch(U){console.error("워크플로우 불러오기 실패:",U),alert("워크플로우 파일을 불러오는데 실패했습니다.")}};return(N,C)=>(l(),a("div",Cs,[e("div",Ns,[C[7]||(C[7]=e("div",{class:"flex items-center gap-4"},[e("h1",{class:"text-xl font-bold text-foreground"},"워크플로우 빌더 V3.0"),e("div",{class:"text-sm text-muted-foreground"},"4포트 시스템 + 키 드래그드롭 매핑")],-1)),e("div",Ss,[e("button",{onClick:x,class:"flex items-center gap-2 rounded-lg bg-yellow-500 px-4 py-2 text-white transition-colors hover:bg-yellow-600"}," ⭐ START 노드 "),e("button",{onClick:xe,disabled:$(t).isExecuting||$(t).nodes.length===0,class:"flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground transition-colors hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-50"},[$(t).isExecuting?(l(),a("svg",Ms,[...C[3]||(C[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(l(),a("svg",Ts,[...C[4]||(C[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"},null,-1)])])),be(" "+k($(t).isExecuting?"실행 중...":"워크플로우 실행"),1)],8,$s),e("button",{onClick:C[0]||(C[0]=(...T)=>$(t).resetExecution&&$(t).resetExecution(...T)),disabled:$(t).isExecuting,class:"rounded-lg bg-muted px-4 py-2 text-muted-foreground transition-colors hover:bg-muted/80 disabled:cursor-not-allowed disabled:opacity-50"}," 초기화 ",8,js),e("button",{onClick:le,class:"flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground transition-colors hover:bg-primary/90"},[...C[5]||(C[5]=[e("svg",{class:"size-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})],-1),be(" 저장 ",-1)])]),e("button",{onClick:me,class:"flex items-center gap-2 rounded-lg bg-secondary px-4 py-2 text-secondary-foreground transition-colors hover:bg-secondary/90"},[...C[6]||(C[6]=[e("svg",{class:"size-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),be(" 불러오기 ",-1)])]),e("input",{ref_key:"fileInputRef",ref:c,type:"file",accept:".json",onChange:ae,class:"hidden"},null,544),e("button",{onClick:C[1]||(C[1]=(...T)=>$(t).clearAll&&$(t).clearAll(...T)),class:"rounded-lg bg-destructive px-4 py-2 text-destructive-foreground transition-colors hover:bg-destructive/90"}," 전체 삭제 ")])]),e("div",Os,[e("div",{class:E(["relative overflow-hidden bg-gradient-to-br from-background via-muted/10 to-background",g.value?"flex-[2]":"flex-1"]),onClick:O,onMousemove:A,onMouseup:R,ref_key:"canvasRef",ref:n},[C[9]||(C[9]=e("div",{class:"absolute inset-0 opacity-20",style:{"background-image":"radial-gradient(circle, oklch(var(--muted-foreground)) 1px, transparent 1px)","background-size":"20px 20px"}},null,-1)),V(xt,{connections:$(t).connections,nodes:$(t).nodes,getNodeConfig:$(t).getServerConfig,onUnlink:ne},null,8,["connections","nodes","getNodeConfig"]),(l(!0),a(z,null,I($(t).nodes,T=>(l(),de(Qe,{key:T.id,node:T,isSelected:$(t).selectedNodeId===T.id,config:$(t).getServerConfig(T.server),connectionMode:$(t).connectionMode,onMousedown:v,onContextmenu:Z,onPortClick:$(t).handlePortClick,onAddNext:ge,onShowMappings:ve},null,8,["node","isSelected","config","connectionMode","onPortClick"]))),128)),e("div",As,[C[8]||(C[8]=e("div",{class:"mb-3 text-sm font-semibold text-foreground"},"도구 팔레트",-1)),e("div",Es,[(l(!0),a(z,null,I(d.value,(T,U)=>(l(),a("button",{key:U,onClick:q=>y(U,T),class:"flex w-full items-center gap-2 rounded-lg bg-muted/50 px-3 py-2 text-left text-sm transition-colors hover:bg-accent/50"},[e("span",Ps,k($(t).getServerConfig(T.server).icon),1),e("div",Us,[e("div",Vs,k(T.description),1),e("div",zs,k(T.server),1)])],8,Ds))),128))])])],34),g.value?(l(),a("div",Is,[V(_s)])):P("",!0),e("button",{onClick:C[2]||(C[2]=T=>g.value=!g.value),class:"absolute right-4 top-4 z-10 flex items-center gap-2 rounded-lg border border-border/30 bg-card/95 px-3 py-2 shadow-lg backdrop-blur-xl transition-colors hover:bg-card",title:g.value?"데이터 뷰어 닫기":"데이터 뷰어 열기"},[C[10]||(C[10]=e("svg",{class:"size-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("span",Bs,k(g.value?"데이터 숨기기":"데이터 보기"),1)],8,Rs)]),V(Co),V(So,{visible:f.value,node:h.value,position:_.value,onToggleStart:H,onDuplicate:re,onRemoveAllConnections:ce,onDelete:pe,onClose:W},null,8,["visible","node","position"]),i.value?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:J(Q,["self"])},[e("div",Ls,[e("div",{class:"mb-4 flex items-center justify-between"},[C[12]||(C[12]=e("h3",{class:"text-lg font-semibold text-foreground"},"다음 앱 선택",-1)),e("button",{onClick:Q,class:"text-muted-foreground transition-colors hover:text-foreground"},[...C[11]||(C[11]=[e("svg",{class:"size-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Ys,[(l(!0),a(z,null,I(d.value,(T,U)=>(l(),a("button",{key:U,onClick:q=>fe(U,T),class:"rounded-lg border border-border/20 bg-muted/50 px-4 py-3 text-left transition-colors hover:border-primary/30 hover:bg-accent/50"},[e("div",Ws,[e("span",qs,k($(t).getServerConfig(T.server).icon),1),e("div",Gs,[e("div",Js,k(T.description),1),e("div",Hs,k(T.server),1)])])],8,Fs))),128))])])])):P("",!0)]))}},vn=F(Xs,[["__scopeId","data-v-2b5ee785"]]);export{vn as default};
