/* empty css                                                                 */import{r as o,e as I,z as O,l as z,o as f,c as A,a as l,n as r,t as u,h as B,i as C}from"./index-6605b047.js";const N={class:"container"},V={class:"row"},$={class:"col"},j=l("li",null,"New OHLC Data:",-1),M={class:"row"},E={class:"col"},x=1,K={__name:"PluginWebsocket_tabChart",props:{message:Object},setup(g){const i=g,d=o({types:i.message.types,ticker:i.message.ticker,candlecnt:i.message.candlecnt,timeInterval:i.message.timeInterval}),h=o([{data:[]}]),m=o({chart:{type:"candlestick",height:350,animations:{enabled:!1}},xaxis:{type:"datetime"},legend:{show:!0,position:"left"},annotations:{yaxis:Array.from({length:6},()=>({y:0,type:"numeric",borderColor:"#FF4560",label:{borderColor:"#FF4560",style:{show:!0,color:"#999",offsetX:0,offsetY:0,lineWidth:2},text:""}}))},plotOptions:{candlestick:{colors:{upward:"#FF4560",downward:"#0070FF"}}}}),t=o({candle_date_time_kst:0,opening_price:0,high_price:0,low_price:0,trade_price:0}),k=o([]),b=o([]),P=async e=>{const a=await new Response(e.data).json(),p=Math.floor(a.timestamp/(24*60*60*1e3))*(24*60*60*1e3)+9*60*60*1e3;a.code==d.value.ticker&&(S(a,p),T(),console.log("WebSocket data received:",t.value))},S=(e,a)=>{t.value={candle_date_time_kst:a,opening_price:e.opening_price,high_price:e.high_price,low_price:e.low_price,trade_price:e.trade_price},y(t.value.high_price,k),y(t.value.low_price,b),D(t.value.candle_date_time_kst,[t.value.opening_price,t.value.high_price,t.value.low_price,t.value.trade_price])},T=()=>{const e=m.value.annotations.yaxis,a=t.value;let p=1.012,_=1.01;a.low_price*.01;const v=[{label:"[trate] ",y:a.trade_price*p,color:"#FFA500"},{label:"[tolerrance] ",y:a.low_price,color:"#008080"},{label:"[brate] ",y:a.trade_price*_,color:"#800080"}];e[0].lineWidth=12,e[1].lineWidth=23,e[2].lineWidth=34,e[3].lineWidth=21,e[4].lineWidth=12,e[5].lineWidth=23;for(let n=0;n<v.length;n++)e[n].y=v[n].y,e[n].label.text=v[n].label+v[n].y,e[n].borderColor=v[n].color,e[n].label.style.background=v[n].color;W(4,b),W(5,k)},F=()=>{try{const e=new WebSocket("wss://api.upbit.com/websocket/v1");e.onopen=a=>{e.send(JSON.stringify([{ticket:"test"},{type:"ticker",codes:[d.value.ticker]}]))},e.onclose=a=>{console.error("WebSocket closed:",a)},e.onmessage=P}catch(e){console.error("Error fetching candle data:",e)}};I(()=>{F()});const y=(e,a)=>{e!==a.value[a.value.length-1]&&a.value.push(e),a.value.length>x&&a.value.shift()},D=(e,a)=>{h.value[0].data.length>=x&&h.value[0].data.shift(),h.value[0].data.push({x:e,y:a})},W=(e,a)=>{const p=m.value.annotations.yaxis,_=a.value[a.value.length-2];p[e].y=_,p[e].label.text=`[${e===4?"pl":"ph"}] ${_}`},w=o(t.value.trade_price),c=o(!1),s=o(!1);return O(t,()=>{t.value.trade_price>w.value?(c.value=!0,s.value=!1):t.value.trade_price<w.value&&(c.value=!1,s.value=!0),w.value=t.value.trade_price,setTimeout(()=>{c.value=!1,s.value=!1},1e3)}),(e,a)=>{const p=z("apexchart");return f(),A("div",N,[l("div",V,[l("div",$,[l("ul",null,[l("li",{class:r({"changed-up":c.value,"changed-down":s.value})},"Types: "+u(d.value.types),3),l("li",{class:r({"changed-up":c.value,"changed-down":s.value})},"Ticker: "+u(d.value.ticker),3),l("li",{class:r({"changed-up":c.value,"changed-down":s.value})},"Candle Count: "+u(d.value.candlecnt),3),l("li",{class:r({"changed-up":c.value,"changed-down":s.value})},"Time Interval: "+u(d.value.timeInterval),3),j,l("li",{class:r({"changed-up":c.value,"changed-down":s.value})},"Candle Date Time KST: "+u(t.value.candle_date_time_kst),3),l("li",{class:r({"changed-up":c.value,"changed-down":s.value})},"Opening Price: "+u(t.value.opening_price),3),l("li",{class:r({"changed-up":c.value,"changed-down":s.value})},"High Price: "+u(t.value.high_price),3),l("li",{class:r({"changed-up":c.value,"changed-down":s.value})},"Low Price: "+u(t.value.low_price),3),l("li",{class:r({"changed-up":c.value,"changed-down":s.value})},"Trade Price: "+u(t.value.trade_price),3)])])]),l("div",M,[l("div",E,[B(p,{type:"candlestick",options:m.value,series:h.value},null,8,["options","series"])])])])}}},L={__name:"TsWebsocket",setup(g){const i=o({types:"candle",ticker:"KRW-BTC",candlecnt:123,timeInterval:"days"});return i.value.ticker,(d,h)=>(f(),C(K,{message:i.value,key:i.value},null,8,["message"]))}},X={__name:"PluginWebsocket_tabChartView",setup(g){return(i,d)=>(f(),C(L))}};export{X as default};
