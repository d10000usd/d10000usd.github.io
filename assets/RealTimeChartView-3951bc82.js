import{W as M,r as R}from"./WebsocketConnector-a01fbebf.js";import{r as i,f as d,q as W,w as E,z as B,_ as k,i as w,o as m,c as b,a as s,t as _,n as U,u as o,F as j,p as x,m as S,h as $,b as L,s as h,v as p,e as A,d as N}from"./index-ba7b35de.js";import{a as z}from"./axios-28bc18a3.js";import{t as f}from"./telegramini-7c8677f3.js";const K="6"+f.t,P="1"+f.i,y=i(""),F=async n=>{try{const e=`
<span class="tg-spoiler">spoiler</span>
<b>Alarm</b> - <strong>Setting values enough</strong>
<i>Value changes </i> 
<tg-emoji emoji-id="5368324170671202286">ğŸ‘</tg-emoji> 
<a href="https://d10000usd.github.io/TsWebsocket_main?message=%22KRW-BTC%22">Chart</a>
${JSON.stringify(n.text,null,2)}
`;if(e.length>1){const t=await z.post(`https://api.telegram.org/bot${K}/sendMessage`,{chat_id:P,text:e,parse_mode:"HTML"},{headers:{"Content-Type":"application/json"}});return!0}else return!1}catch(e){console.error("Error sending message:",e)}},v=async n=>{const t=await F({text:n});return y.value=t?"ok":"error",1};class q{constructor(e,t){this.coinlist=i(Object.assign([],e.message)),this.monitoringCoin=t.monitoringCoin,this.sortingOrderkey=i(t.sortingOrder),this.settingValue=i(t.settingValue),this.shouldExecute=t.shouldExecute,this.messageCounter=0,this.componentname=t.componentname,this.status=t.status,this.asc_desc=t.asc_desc,this.coinea=t.coinea,this.eta=t.eta,this.addRatio=t.addRatio,this.alarmSenddingEa=t.alarmSenddingEa,this.maxrangeSt=t.maxrange,this.minrangeSt=t.minrange}calculateRange(e){var a;const t=(a=this.logicInstance2.sortedWsData.value[this.monitoringCoin])==null?void 0:a[this.sortingOrderkey.value];return t!==void 0?t+t*(e/100):null}initialize(){this.logicInstance2=new M(this.coinlist.value,"TelegramAlarmLogic_RISE",this.sortingOrderkey.value,this.asc_desc,this.coinea,this.eta),this.ticker=d(()=>{var e;return(e=this.logicInstance2.sortedWsData.value[this.monitoringCoin])==null?void 0:e.code}),this.trade_price=d(()=>{var e;return(e=this.logicInstance2.sortedWsData.value[this.monitoringCoin])==null?void 0:e.trade_price}),this.sortingOrderValue=d(()=>{var e;return(e=this.logicInstance2.sortedWsData.value[this.monitoringCoin])==null?void 0:e[this.sortingOrderkey.value]}),this.maxrange=d(()=>this.calculateRange(this.maxrangeSt)),this.minrange=d(()=>this.calculateRange(this.minrangeSt)),console.log(this.sortingOrderValue),this.telemsg=W({Status:this.status,assets:this.ticker,Comparekey:this.sortingOrderkey.value,sortingOrderValue:this.sortingOrderValue,trade_price:this.trade_price,settingValue:this.settingValue.value,execution:this.componentname,minrange:{"r%":this.minrangeSt,v:this.minrange},maxrange:{"r%":this.maxrangeSt,v:this.maxrange}}),E(()=>this.settingValue.value,e=>{this.telemsg.settingValue=e}),B(()=>{this.telemsg.sortingOrderValue>this.settingValue.value&&this.shouldExecute&&(this.shouldExecute=!1,setTimeout(()=>{this.sendMessageAndUpdateStatus(),this.messageCounter++,this.messageCounter===this.alarmSenddingEa&&(this.settingValue.value+=this.addRatio,this.messageCounter=0,this.telemsg["next Value"]=this.settingValue.value,this.sendMessageAndUpdateStatus(),delete this.telemsg["next Value"]),this.shouldExecute=!0},1e3))})}run(){this.initialize()}sendMessageAndUpdateStatus(){v(this.telemsg)}}const H=n=>(x("data-v-2d0b4d56"),n=n(),S(),n),J=H(()=>s("br",null,null,-1)),G={__name:"TelegramMsg_BTC",props:["message","takenconinticker","dictionarys","componentname"],setup(n){const e=n,t=i(y);let a={assets:e.dictionarys,execution:e.componentname};return w(()=>{v(a)}),(u,r)=>(m(),b(j,null,[s("button",{class:U(["telebtn",{greenBtn:t.value==="ok",redBtn:t.value==="error"}]),onClick:r[0]||(r[0]=c=>o(v)(o(a)))}," tele :: "+_(t.value),3),J],64))}},Q=k(G,[["__scopeId","data-v-2d0b4d56"]]);const V=n=>(x("data-v-a398448e"),n=n(),S(),n),X={class:"body-full"},Y={class:"spacing mb-11"},Z={class:"c-custom-card"},D=V(()=>s("label",{for:"settingValue"},"Setting Value:",-1)),ee=V(()=>s("label",{for:"monitoringCoin"},"Monitoring Coin:",-1)),te=V(()=>s("label",{for:"sortingOrder"},"Sorting Order:",-1)),se={class:"pre2"},ne="TsWebsocket_telegram",ae={__name:"TsWebsocket_telegram",props:{message:Object,pncounts:Object},setup(n){const e=n,t=i({monitoringCoin:"KRW-BLUR",sortingOrder:"L52",settingValue:300,shouldExecute:!0,messageCounter:0,componentname:"TsWebsocket_telegram",status:"Rise Monitoring",asc_desc:"asc",coinea:130,eta:0,addRatio:.5,alarmSenddingEa:2,maxrange:2,minrange:1}),a=new q(e,t.value);a.run();const u=i(300),r=i("KRW-BTC"),c=i("L52"),O=()=>{isNaN(u.value)?console.error("Invalid input. Please enter a numeric value."):a.settingValue.value=parseInt(u.value)},T=()=>{r.value?a.monitoringCoin=r.value:console.error("Invalid input. Please enter a numeric value.")},I=()=>{c.value?a.sortingOrderkey.value=c.value:console.error("Invalid input. Please enter a numeric value.")};return(C,l)=>(m(),b("body",X,[s("div",Y,[s("div",Z,[o(a).L52Changes>o(a).settingValue?(m(),$(Q,{key:0,message:e.message,takenconinticker:C.KRW-C.BTC,dictionarys:o(a).telemsg,componentname:ne},null,8,["message","takenconinticker","dictionarys"])):L("",!0),s("h2",null," Realtime "+_(o(a).telemsg.assets),1)])]),s("div",null,[D,h(s("input",{"onUpdate:modelValue":l[0]||(l[0]=g=>u.value=g),type:"number",id:"settingValue"},null,512),[[p,u.value]]),s("button",{onClick:O},"Update Setting Value")]),s("div",null,[ee,h(s("input",{"onUpdate:modelValue":l[1]||(l[1]=g=>r.value=g),type:"text",id:"monitoringCoin"},null,512),[[p,r.value]]),s("button",{onClick:T},"Update Monitoring Coin")]),s("div",null,[te,h(s("input",{"onUpdate:modelValue":l[2]||(l[2]=g=>c.value=g),type:"text",id:"sortingOrder"},null,512),[[p,c.value]]),s("button",{onClick:I},"Update Sorting Order")]),s("pre",se,_(o(a).telemsg),1)]))}},ie=k(ae,[["__scopeId","data-v-a398448e"]]),oe={class:"container body-full"},re=s("br",null,null,-1),de={__name:"RealTimeChartView",setup(n){return(e,t)=>(m(),b("body",oe,[A(ie,{message:o(R)},null,8,["message"]),N(),re]))}};export{de as default};
