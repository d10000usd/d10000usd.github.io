import{u as D}from"./WebsocketConnector-97256fd0.js";import{C as b}from"./lightweight-charts.production-47dedeea.js";import{f as M,a as m}from"./chartOptions-44de04f6.js";import{l as f,r as v,g,o as V,c as $,a as i,t as B,u as O,w as R}from"./index-779b63d9.js";const F={class:"body-full"},j={class:"spacing mb-11"},z={class:"c-custom-card"},G={__name:"TsWebsocket_Report",props:["message"],setup(p){const{message:o}=p,{sortedWsData:S}=D([o],"TsWebsocket_Report","signed_change_rate","asc"),E=f({types:"candle",ticker:o,candlecnt:30,timeInterval:"days"}),I=f({types:"candle",ticker:o,candlecnt:54,timeInterval:"weeks"}),L=f({types:"candle",ticker:o,candlecnt:24,timeInterval:"months"}),x=f({types:"candle",ticker:o,candlecnt:330,timeInterval:"minute240"}),k=v(null),C=v(null),_=v(null),w=v(null);let c;const u=async(s,t,e)=>{t.value&&t.value.children.length>0&&(t.value.innerHTML=""),c=b(t.value,{width:390,height:300});const n=c.addCandlestickSeries({priceLineVisible:!1,priceScale:{position:"left"}});c.applyOptions(s);const l=document.createElement("div");l.textContent=`Ticker: ${e.candlecnt} ${e.timeInterval} `,t.value.appendChild(l);try{await y(c,n,e)}catch(a){console.error("Error fetching candle data:",a)}R(()=>e.ticker,async(a,r)=>{if(r&&r.length>=3&&a!==r){c.remove(),c=b(t.value,{width:390,height:300});const d=c.addCandlestickSeries({priceLineVisible:!1,priceScale:{position:"left"}}),h=document.createElement("div");h.textContent=`Tickerssss: ${e} ${e}`,t.value.appendChild(h);try{await y(c,d,e)}catch(A){console.error("Error fetching candle data:",A)}}})};function W(s,t){const e=[];for(let n=t-1;n<s.length;n++){const a=s.slice(n-(t-1),n+1).reduce((r,d)=>r+d.close,0)/t;e.push({time:s[n].time,value:a})}return e}async function y(s,t,e){try{const n=await M(e.types,e.ticker,e.candlecnt,e.timeInterval,e.minType);t.setData(n);for(const[l,a]of Object.entries(m.movingAverages)){const r=parseInt(l.replace("ma",""),10),d=s.addLineSeries({color:a.color,lineWidth:a.lineWidth,priceLineVisible:a.priceLineVisible==="true"}),h=W(n,r);d.setData(h)}}catch(n){console.error("Error fetching candle data:",n)}}return g(()=>u(m,k,E)),g(()=>u(m,C,I)),g(()=>u(m,_,L)),g(()=>u(m,w,x)),(s,t)=>(V(),$("body",F,[i("div",j,[i("div",z,[i("p",null,"Received Message: "+B(O(S)[p.message]),1),i("div",{ref_key:"chartContainer0",ref:k},null,512),i("div",{ref_key:"chartContainer1",ref:C},null,512),i("div",{ref_key:"chartContainer2",ref:_},null,512),i("div",{ref_key:"chartContainer3",ref:w},null,512)])])]))}};export{G as default};
